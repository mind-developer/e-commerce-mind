jQuery(document).ready((function(e){"use strict";var t={init:function(){e(document).on("click","#publish",t.ajaxSave),t.addEditWrapperClass(),t.initElementControls(),t.initShortcodes(),t.initAddonOptions()},ajaxSave:function(t){if("publish"==e("#original_post_status").val()&&void 0!==window.vc&&void 0!==wolmart_wpb_admin_vars.wpb_backend_ajax&&"1"==wolmart_wpb_admin_vars.wpb_backend_ajax){t.preventDefault(),"object"==typeof tinymce&&tinymce.editors.content&&!e("#post-body-content .composer-switch").hasClass("vc_backend-status")&&"tinymce"==getUserSetting("editor")?tinymce.editors.content.save():"html"==getUserSetting("editor")&&e("#content-tmce").trigger("click");var a=e("#content"),i=a.val(),n=wp.i18n.__;0==i.indexOf("<p>[")&&(i=i.trim().slice(3,-4),a.val(i)),e(this).html(n("Updating..","wolmart-core")).val("Updating.."),e("#wpb-save-post").html(n("Loading..","wolmart-core")),e.ajax({url:wolmart_wpb_admin_vars.ajax_url.replace("admin-ajax","post"),data:e("#post").serialize(),method:"post",success:function(t){var a=e('<div class="wpb-alert wpb-alert-success">'+n("Successfully Updated.","wolmart-core")+"</div>");e("body").append(a),e("#wpb-save-post").html(n("Update","wolmart-core")),e("#publish").html(n("Update","wolmart-core")).attr("value","Update"),a.fadeIn(400);var i=setTimeout((function(){a.fadeOut(900,(function(){a.remove()}))}),3500);a.on("click",(function(e){clearTimeout(i),a.fadeOut(900,(function(){a.remove()}))}))}}).fail((function(t){var a=e('<div class="wpb-alert wpb-alert-fail">'+n("Updated Failed.","wolmart-core")+"</div>");e("body").append(a),a.fadeIn(400),e("#wpb-save-post").html(n("Update","wolmart-core")),e("#publish").html(n("Update","wolmart-core")).attr("value","Update");var i=setTimeout((function(){a.fadeOut(900,(function(){a.remove()}))}),3500);a.on("click",(function(e){clearTimeout(i),a.fadeOut(900,(function(){a.remove()}))}))}))}},initElementControls:function(){if(e("body").on("click",".vc_edit-form-tab .wpb_el_type_wolmart_accordion_header",(function(){if(e(this).siblings(".wpb_el_type_wolmart_accordion_header").removeClass("opened"),e(this).hasClass("opened"))e(this).removeClass("opened"),e(this).siblings(".vc_column:not(.wpb_el_type_wolmart_accordion_header)").removeClass("show");else{e(this).addClass("opened"),e(this).siblings().removeClass("show");for(var t=e(this).next();t.length&&!t.hasClass("wpb_el_type_wolmart_accordion_header");)t.addClass("show"),t=t.next()}})),e("body").on("click","#vc_ui-panel-edit-element .vc_ui-tabs-line .vc_ui-tabs-line-trigger",(function(){var t=e("#vc_ui-panel-edit-element .vc_edit-form-tab.vc_active .wpb_el_type_wolmart_accordion_header").eq(0);t.length&&!t.hasClass("opened")&&t.trigger("click")})),e("#vc_ui-panel-wolmart-popup-options").length&&e("#vc_post-custom-css").after('<input type="hidden" name="wolmart_popup_options" id="wolmart_popup_options" value="" autocomplete="off">'),!e(document.body).hasClass("block-editor-page")&&e("#vc_ui-panel-post-settings .custom_css").length){e("#wolmart-post-layout-meta-box #page_css").attr("disabled","disabled");var t=e("#wolmart-post-layout-meta-box #page_css").val();t&&(e("#vc_post-custom-css").val(t+e("#vc_post-custom-css").val()),e("#wolmart-post-layout-meta-box #page_css").val(""))}},initAddonOptions:function(){e("body").on("click",'#vc_ui-panel-wolmart-popup-options [data-vc-ui-element="button-save"]',(function(){var t=e("#vc_ui-panel-wolmart-popup-options"),a=t.find("#vc_popup-width-field").val(),i=t.find("#vc_popup-h_pos-field").val(),n=t.find("#vc_popup-v_pos-field").val(),o=t.find("#vc_popup-border-field").val(),r=t.find("#vc_popup-margin-top-field").val(),l=t.find("#vc_popup-margin-right-field").val(),d=t.find("#vc_popup-margin-bottom-field").val(),s=t.find("#vc_popup-margin-left-field").val(),c=t.find("#vc_popup-animation-field").val(),p=t.find("#vc_popup-anim-duration-field").val(),m={width:a||600,h_pos:i||"center",v_pos:n||"center",border:o||"0",top:r||"",right:l||"",bottom:d||"",left:s||"",popup_animation:c,popup_anim_duration:p||400};e("#wolmart_popup_options").val(JSON.stringify(m))}))},addEditWrapperClass:function(){wolmart_core_vars&&wolmart_core_vars.template_type&&e("#visual_composer_content").addClass("wpb-wolmart-"+wolmart_core_vars.template_type+"-builder")},initShortcodes:function(){if(e("body").hasClass("vc_inline-shortcode-edit-form")){var t=function(e,t){for(;t;){var a=e%t;e=t,t=a,z}return e},a=function(e){var t=document.getElementById("vc_inline-frame").contentWindow.Wolmart,a=(0,document.getElementById("vc_inline-frame").contentWindow.jQuery)("[data-model-id="+e+"]").closest(".slider-wrapper");a.data("slider")&&(a.data("slider").destroy(),a.removeData("slider")),t.slider(a)},i=function(a,i,n,o){if(a.length){var r=document.getElementById("vc_inline-frame").contentWindow.Wolmart,l=(document.getElementById("vc_inline-frame").contentWindow.jQuery,a.data("creative-preset")),d=a.data("creative-layout");void 0===d&&(d=[]);for(var s=n;s<=o;s++){var c=a.children(".vc_element").eq(s).children(".vc_element-container"),p=c.attr("class"),m=c.data("creative-item"),v={},h=["w","w-xl","w-l","w-m","w-s"],w=["h","h-xl","h-l","h-m","h-s"];l[s]?v=l[s]:(v.w="1-4",v["w-l"]="1-2",v.h="1-3");for(var f=0;f<5;f++)if(m[h[f]])for(var u=f;u<5;u++)v[h[u]]=m[h[f]];for(f=0;f<5;f++)m[w[f]]&&"preset"!=m[w[f]]&&"child"!=m[w[f]]&&(v[w[f]]=m[w[f]]);(p=(p=c.parent(".vc_wpb_wolmart_masonry_item").attr("class")).match(/(grid-item .* grid-item-end-class)/g))&&c.parent(".vc_wpb_wolmart_masonry_item").removeClass(p[0]),c.removeAttr("data-creative-item"),p="grid-item ",Object.entries(v).forEach((function(e){p+=e[0]+"-"+e[1]+" "})),p+="grid-item-end-class",c.parent(".vc_wpb_wolmart_masonry_item").addClass(p).attr("data-creative-item",JSON.stringify(v)),d[s]=v;var _=["","-xl","-lg","-md","-sm"];for(f=0;f<_.length;f++)c.parent().attr("data-creative-order"+_[f],null==c.attr("data-creative-order"+_[f])?c.parent().index()+1:c.attr("data-creative-order"+_[f]))}a.data("creative-layout",d),a.children(".grid-space").remove(),a.append(e('<div class="grid-space"></div>')),a.before("style").remove(),a.before(function(e,a,i,n){if(void 0!==a){var o=[],r=[],l="",d={w:[],"w-l":[],"w-m":[],"w-s":[]},s={h:[],"h-l":[],"h-m":[]};l+='<style scope="">',a.map((function(e){Object.entries(e).forEach((function(e){if("size"!=e[0]){var t=e[1].split("-");null!=t[1]&&-1==o.indexOf(t[1])&&o.push(t[1]),-1==r.indexOf(t[0])&&r.push(t[0]),"w"!=e[0]&&"w-l"!=e[0]&&"w-m"!=e[0]&&"w-s"!=e[0]||-1!=d[e[0]].indexOf(e[1])?"h"!=e[0]&&"h-l"!=e[0]&&"h-m"!=e[0]||-1!=s[e[0]].indexOf(e[1])||s[e[0]].push(e[1]):d[e[0]].push(e[1])}}))})),Object.entries(d).forEach((function(t){t[1].length&&("w-xl"==t[0]?l+="@media (max-width: 1199px) {":"w-l"==t[0]?l+="@media (max-width: 991px) {":"w-m"==t[0]?l+="@media (max-width: 767px) {":"w-s"==t[0]&&(l+="@media (max-width: 575px) {"),t[1].map((function(a){var i=a.split("-"),n=null==i[1]?100:(100*i[0]/i[1]).toFixed(4);l+="."+e+" .grid-item."+t[0]+"-"+a+"{flex:0 0 "+n+"%;width:"+n+"%}"})),"w-xl"!=t[0]&&"w-l"!=t[0]&&"w-m"!=t[0]&&"w-s"!=t[0]||(l+="}"))})),Object.entries(s).forEach((function(t){t[1].length&&t[1].map((function(a){var o,r=a.split("-");o=null!=r[1]?i*r[0]/r[1]:i,"h"==t[0]?(l+="."+e+" .h-"+a+"{height:"+o.toFixed(2)+"px}",l+="@media (max-width: 767px) {",l+="."+e+" .h-"+a+"{height:"+(o*n/100).toFixed(2)+"px}",l+="}"):"h-xl"==t[0]?(l+="@media (max-width: 1199px) {",l+="."+e+" .h-xl-"+a+"{height:"+o.toFixed(2)+"px}",l+="}",l+="@media (max-width: 767px) {",l+="."+e+" .h-xl-"+a+"{height:"+(o*n/100).toFixed(2)+"px}",l+="}"):"h-l"==t[0]?(l+="@media (max-width: 991px) {",l+="."+e+" .h-l-"+a+"{height:"+o.toFixed(2)+"px}",l+="}",l+="@media (max-width: 767px) {",l+="."+e+" .h-l-"+a+"{height:"+(o*n/100).toFixed(2)+"px}",l+="}"):"h-m"==t[0]?(l+="@media (max-width: 767px) {",l+="."+e+" .h-m-"+a+"{height:"+(o*n/100).toFixed(2)+"px}",l+="}"):"h-s"==t[0]&&(l+="@media (max-width: 575px) {",l+="."+e+" .h-s-"+a+"{height:"+o.toFixed(2)+"px}",l+="}")}))}));var c=1;o.map((function(e){c=c*e/t(c,e)}));var p=r[0];r.map((function(e){p=t(p,e)}));var m=Math.floor(100*p/c*1e4)/1e4;return l+="."+e+".grid>.grid-space{flex: 0 0 "+(m<.01?100:m)+"%;width:"+(m<.01?100:m)+"%}",l+="</style>"}}(a.data("creative-id"),a.data("creative-layout"),a.data("creative-height"),a.data("creative-height-ratio"))),a.data("isotope")&&a.isotope("destroy"),a.hasClass("grid-float")&&a.children(".grid-item").each((function(){e(this).css({position:"",left:"",top:""})})),r.isotopes(a);var b=a.find(".slider-wrapper").data("slider");b&&b.update(),e(window).trigger("resize")}};if(window.InlineShortcodeView){window.InlineShortcodeView.prototype.destroy;window.InlineShortcodeView.prototype.destroy=function(e){vc.events.trigger("shortcodeView:destroy",this.model),e&&e.preventDefault&&e.preventDefault(),e&&e.stopPropagation&&e.stopPropagation(),vc.showMessage(window.sprintf(window.i18nLocale.inline_element_deleted,this.model.setting("name"))),this.model.destroy()}}window.vc.events.on("shortcodeView:ready",(function(t){if(t.view&&t.view.$el){var n=document.getElementById("vc_inline-frame").contentWindow.Wolmart,o=document.getElementById("vc_inline-frame").contentWindow.jQuery,r=t.attributes.shortcode,l=t.view.$el,d=t.view.model.attributes.id;if("wpb_wolmart_masonry_item"==r){var s=o("[data-model-id="+d+"]").parent(".wolmart-masonry-container");i(s,0,l.index(),l.siblings(".grid-item").length)}else if("wpb_wolmart_masonry"==r){s=o("[data-model-id="+d+"]").children(".wolmart-masonry-container");i(s,0,0,l.children(".vc_element-container").children(".vc_element").length-1)}else if("wpb_wolmart_carousel"==r){var c=o("[data-model-id="+d+"]").children(".wolmart-carousel-container").children(".slider-wrapper");c.children(".slider-slide:not(.slider-slide-duplicate)").each((function(){c.append(e(this).children())})),c.siblings(".slider-button, .slider-pagination").remove(),n.slider(c)}else if("wpb_wolmart_tab"==r){var p=l.children(".wolmart-tab-container").children(".tab").children(".nav-tabs");l.children(".wolmart-tab-container").children(".tab").children(".tab-content").children().each((function(){p.append(e('<li class="nav-item"><a class="nav-link'+(e(this).hasClass("active")?" active":"")+'" href="#" target="_blank">'+e(this).children(".wolmart-tab-item-container").data("tab-title")+"</a></li>"))}))}else if("wpb_wolmart_tab_item"==r)l.children(".wolmart-tab-item-container").removeClass("tab-pane"),l.addClass("tab-pane"),l.siblings(".active").length&&l.children(".wolmart-tab-item-container").removeClass("active"),l.children(".wolmart-tab-item-container").hasClass("active")&&l.addClass("active"),1==t.attributes.cloned?l.closest(".tab").find(".nav-tabs").children(".nav-item").eq(l.index()-1).after(e('<li class="nav-item"><a class="nav-link" href="#" target="_blank">'+l.children(".wolmart-tab-item-container").data("tab-title")+"</a></li>")):l.closest(".tab").find(".nav-tabs > .nav-item").eq(l.index()-1).length?l.closest(".tab").find(".nav-tabs > .nav-item").eq(l.index()).children(".nav-link").text(l.children(".wolmart-tab-item-container").data("tab-title")):l.closest(".tab").find(".nav-tabs").append(e('<li class="nav-item"><a class="nav-link" href="#" target="_blank">'+l.children(".wolmart-tab-item-container").data("tab-title")+"</a></li>"));else if("wpb_wolmart_accordion"==r){var m=l.children(".wolmart-accordion-container").data("accordion-icon"),v=l.children(".wolmart-accordion-container").data("accordion-active-icon");l.find(" > .wolmart-accordion-container > .accordion > .card").each((function(){var t=e(this).find("> .wolmart-accordion-item-container > .card-header > a");t.find(".toggle-icon").remove(),m&&t.append(e('<span class="toggle-icon closed"><i class="'+m+'"></i></span>')),v&&t.append(e('<span class="toggle-icon opened"><i class="'+v+'"></i></span>'))}))}else if("wpb_wolmart_accordion_item"==r){m=l.closest(".wolmart-accordion-container").data("accordion-icon"),v=l.closest(".wolmart-accordion-container").data("accordion-active-icon");var h=l.find(" > .wolmart-accordion-item-container > .card-header > a"),w=l.closest(".accordion");l.addClass("card"),l.children(".wolmart-accordion-item-container").removeClass("card"),m&&!h.children(".closed").length&&h.append(e('<span class="toggle-icon closed"><i class="'+m+'"></i></span>')),v&&!h.children(".opened").length&&h.append(e('<span class="toggle-icon opened"><i class="'+v+'"></i></span>')),w.find("> .card > .wolmart-accordion-item-container > .card-header > .collapse").length||(h.addClass("collapse").removeClass("expand"),h.parent(".card-header").siblings(".card-body").removeClass("collapsed").addClass("expanded"))}(l.parent().hasClass("slider-slide")||l.parent().hasClass("slider-wrapper"))&&a(d)}})),window.vc.events.on("shortcodeView:destroy",(function(e){var t=e.attributes.shortcode,i=e.view.$el,n=e.view.model.attributes.id;if("wpb_wolmart_tab_item"==t){var o=i.index();i.closest(".tab").children(".nav-tabs").children(".nav-item").eq(o).remove(),i.hasClass("active")&&(i.closest(".tab").children(".nav-tabs").children(".nav-item:first-child").find("a").addClass("active"),i.parent().children(".tab-pane:nth-child("+(0==o?2:1)+")").addClass("active"))}i.parent().hasClass("slider-slide")&&a(n)}))}}};t.init()}));