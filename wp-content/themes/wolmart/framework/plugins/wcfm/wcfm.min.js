"use strict";window.Wolmart||(window.Wolmart={}),function(e){var t,a,i={init:function(){e(document.body).on("click","#wcfm_products_manage_form_swatch_head",(function(e){e.preventDefault(),i.renderSwatchView()})),e("#product_type").length>0&&e("#product_type").change((function(){"variable"==e(this).val()&&i.renderSwatchView()})),this.renderSwatchView=this.renderSwatchView.bind(this),this.onAddImage=this.onAddImage.bind(this),this.onSelectImage=this.onSelectImage.bind(this),this.onRemoveImage=this.onRemoveImage.bind(this)},renderSwatchView:function(){var t={action:"generate_image_swatches",wcfm_products_manage_form:e("#wcfm_products_manage_form").serialize(),wcfm_swatch_nonce:wcfm_lib_swatch.wcfm_swatch_nonce};e.ajax({type:"POST",url:wolmart_vars.ajax_url,data:t,success:function(t){t.attr_enabled&&(e("#wcfm_products_manage_form_image_swatches_empty_expander").addClass("wcfm_custom_hide"),e("#wcfm_products_manage_form_image_swatches_expander").removeClass("wcfm_custom_hide"),t.swatch_count!==e("#wcfm_products_manage_form_image_swatches_expander table tbody tr").length&&e("#wcfm_products_manage_form_image_swatches_expander").html(t.template)),e(".image-swatches-accordion").length&&(Wolmart.accordion("#wolmart-wcfm-swatch-options .card-header > a"),e(".image-swatches-accordion .card-header").on("click",i.resizeWrapperHeight)),e(".img_tip, .text_tip").length>0&&i.initToolTip(),e(".wolmart_wcfm_add_image_button").length>0&&e(document.body).on("click",".wolmart_wcfm_add_image_button",i.onAddImage),e(".wolmart_wcfm_remove_image_button").length>0&&e(document.body).on("click",".wolmart_wcfm_remove_image_button",i.onRemoveImage),e(".wolmart-wcfm-save-changes").length>0&&e(document.body).on("click",".wolmart-wcfm-save-changes",i.onSave)},dataType:"json"})},initToolTip:function(){e(".img_tip, .text_tip").each((function(){e(this).qtip({content:e(this).attr("data-tip"),position:{my:"top center",at:"bottom center",viewport:e(window)},show:{solo:!0},hide:{inactive:6e4,fixed:!0},style:{classes:"qtip-dark qtip-shadow qtip-rounded qtip-wcfm-css qtip-wcfm-core-css"}})}))},resizeWrapperHeight:function(){var t=e(this),a=e(".wcfm-tabWrap");t.parent().parent().find(".card-body.expanded").length>0&&a.height(a.height()-t.parent().parent().find(".card-body.expanded").height()),setTimeout((function(){var e=t.parent().find(".card-body").height();t.find(".collapse").length>0&&a.height(a.height()+e)}),400)},requireSave:function(){e("#wolmart-wcfm-swatch-options .wolmart-wcfm-save-changes").removeAttr("disabled"),e("#wolmart-wcfm-swatch-options .wolmart-wcfm-cancel-changes").removeAttr("disabled")},onSelectImage:function(){var e=t.state().get("selection").first().toJSON();a.siblings("img").attr("src",e.url),a.siblings("input").val(e.id),t.close(),this.requireSave()},onAddImage:function(i){a=e(i.currentTarget),t||(t=wp.media.frames.downloadable_file=wp.media({title:wcfm_lib_swatch.file_frame_title,button:{text:wcfm_lib_swatch.file_frame_btn},multiple:!1})).on("select",this.onSelectImage),t.open(),i.preventDefault()},onRemoveImage:function(t){var a=e(t.currentTarget);a.siblings("img").attr("src",wcfm_lib_swatch.placeholder),a.siblings("input").val(""),this.requireSave(),t.preventDefault()},onSave:function(t){t.preventDefault(),e("#wcfm_products_simple_submit_button").trigger("click")}};Wolmart.Wcfm=i,Wolmart.$window.on("wolmart_complete",(function(){Wolmart.Wcfm.init()}))}(jQuery);