"use strict";window.Wolmart||(window.Wolmart={}),function(t){t(window).on("wolmart_complete",(function(){var a,e,r,o,i={enable:wolmart_fbt_vars.fbt_discount_enable,type:wolmart_fbt_vars.fbt_discount_type,fixed:wolmart_fbt_vars.fbt_discount_fixed,percent:wolmart_fbt_vars.fbt_discount_percentage,condition:wolmart_fbt_vars.fbt_discount_condition,spend:wolmart_fbt_vars.fbt_discount_spend,productCount:wolmart_fbt_vars.fbt_discount_products_count},d=t(".product-fbt").eq(0),c=d.find(".wolmart-data-oldprice");function n(t){var a=i.type,e=0;return 0==t?0:(a&&(e="fixed"==a?t>parseFloat(i.fixed)?parseFloat(t-parseFloat(i.fixed)):t:parseFloat(t-t*parseInt(i.percent)/100)),e)}function l(t,a){if("yes"!=i.condition)return!0;var e=parseFloat(i.spend),r=parseInt(i.productCount);return!(e>0&&r>0&&e>t||r>a)}a=0,e=0,r=0,o=d.find(".wolmart_old_price"),d.find(".product-wrap").each((function(){var e=t(this).find('input[type="checkbox"]'),o=parseFloat(e.data("price"));e.is(":checked")&&(a+=o,r+=1)})),e=n(parseFloat(a)),d.find(".bought-count span").text(parseInt(r)),l(a,r)?o.show():(o.hide(),e=a),e&&a?(o.find(".woocommerce-Price-amount").html("<bdi>"+o.find(".woocommerce-Price-currencySymbol").get(0).outerHTML+a.toFixed(2)+"</bdi>"),d.find(".wolmart-data-oldprice").data("price",a.toFixed(2)).attr("data-price",a.toFixed(2)),d.find(".wolmart_total_price .woocommerce-Price-amount").html("<bdi>"+d.find(".wolmart_total_price .woocommerce-Price-currencySymbol").get(0).outerHTML+e.toFixed(2)+"</bdi>"),d.find(".wolmart-data-price").data("price",e.toFixed(2)).attr("data-price",e.toFixed(2))):(d.find(".wolmart_total_price .woocommerce-Price-amount").html("<bdi>"+d.find(".wolmart_total_price .woocommerce-Price-currencySymbol").get(0).outerHTML+e.toFixed(2)+"</bdi>"),d.find(".wolmart-data-price").data("price",e.toFixed(2)).attr("data-price",e.toFixed(2))),Wolmart.$body.on("change",".product-fbt input",(function(a){var e=t(a.currentTarget).closest(".product-fbt"),r=e.find(".bought-count span"),o=c.length?parseFloat(e.find(".wolmart-data-oldprice").data("price")):0,i=parseFloat(e.find(".wolmart-data-price").data("price")),d=parseFloat(e.find(".wolmart-data-price").data("price")),p=t(this),m=p.data("price")?parseFloat(p.data("price")):0;c.length&&(d=o),a.preventDefault(),p.is(":checked")?(p.closest(".product").removeClass("inactive"),d+=m,r.text(parseInt(r.text())+1)):(p.closest(".product").addClass("inactive"),d-=m,r.text(parseInt(r.text())-1));var f="";e.find("input").each((function(){t(this).is(":checked")&&(f+=(f?",":"")+t(this).data("id"))})),0==d&&(i=0),c.length?(i=n(d),e.find(".wolmart_old_price .woocommerce-Price-amount").html("<bdi>"+e.find(".wolmart_old_price .woocommerce-Price-currencySymbol").get(0).outerHTML+d.toFixed(2)+"</bdi>"),e.find(".wolmart-data-oldprice").data("price",d.toFixed(2)).attr("data-price",d.toFixed(2))):i=d,l(d,parseInt(r.text()))?e.find(".wolmart_old_price").show():(e.find(".wolmart_old_price").hide(),i=d),e.find(".wolmart_add_to_cart_button").attr("value",f),e.find(".wolmart_total_price .woocommerce-Price-amount").html("<bdi>"+e.find(".wolmart_total_price .woocommerce-Price-currencySymbol").get(0).outerHTML+i.toFixed(2)+"</bdi>"),e.find(".wolmart-data-price").data("price",i.toFixed(2)).attr("data-price",i.toFixed(2))})).on("found_variation",".variations_form",(function(a,e){if(t(".product-fbt").length&&e.is_in_stock){var r=e.display_price,o=e.variation_id,i=e.image,d=t(".current-product"),p=d.find(".woocommerce-Price-currencySymbol").get(0).outerHTML,m=t(".product-fbt"),f=m.find(".bought-count span"),u=c.length?parseFloat(m.find(".wolmart-data-oldprice").data("price")):0,s=parseFloat(m.find(".wolmart-data-price").data("price")),_=parseFloat(m.find(".wolmart-data-price").data("price")),w=m.find(".wolmart_add_to_cart_button").attr("value");c.length&&(_=u),d.hasClass("disabled")?(f.text(parseInt(f.text())+1),d.attr("data-content",d.get(0).outerHTML)):(_-=d.find(".price").data("price"),w=(w=w.split(",")).filter((function(t){return t!=""+d.data("id")})).join(",")),w=w+(w?",":"")+o,0==(_+=r)&&(s=0),c.length?(s=n(_),m.find(".wolmart_old_price .woocommerce-Price-amount").html("<bdi>"+p+_.toFixed(2)+"</bdi>"),m.find(".wolmart-data-oldprice").data("price",_.toFixed(2))):s=_,l(_,parseInt(f.text()))?m.find(".wolmart_old_price").show():(m.find(".wolmart_old_price").hide(),s=_),m.find(".wolmart_add_to_cart_button").attr("value",w),m.find(".wolmart_total_price .woocommerce-Price-amount").html("<bdi>"+p+s.toFixed(2)+"</bdi>"),m.find(".wolmart-data-price").data("price",s.toFixed(2)),d.removeClass("disabled"),d.find("input").prop("checked",!0).data("price",r),d.find(".price").get(0).outerHTML='<div class="price" data-price="'+r+'">'+p+r,d.data("id",o),d.find("img").attr("src")!=i.src&&d.find("img").attr("src",i.src).attr("alt",i.alt).attr("width",i.width).attr("height",i.height)}})).on("reset_data",".variations_form",(function(a){if(t(".product-fbt").length){var e=t(".current-product");if(e.attr("data-content")){var r=t(".product-fbt"),o=r.find(".bought-count span"),i=c.length?parseFloat(r.find(".wolmart-data-oldprice").data("price")):0,d=parseFloat(r.find(".wolmart-data-price").data("price")),p=parseFloat(r.find(".wolmart-data-price").data("price")),m=parseFloat(e.find(".price").data("price")),f=r.find(".wolmart_add_to_cart_button").attr("value"),u=e.find(".woocommerce-Price-currencySymbol").get(0).outerHTML;if(c.length&&(p=i),e.find("input").is(":checked"))p-=m,f=(f=f.split(",")).filter((function(t){return t!=""+e.data("id")})).join(","),0==p&&(d=0),c.length?(d=n(p),r.find(".wolmart_old_price .woocommerce-Price-amount").html("<bdi>"+u+p.toFixed(2)+"</bdi>"),r.find(".wolmart-data-oldprice").data("price",p.toFixed(2))):d=p,l(p,parseInt(o.text()))?r.find(".wolmart_old_price").show():(r.find(".wolmart_old_price").hide(),d=p),r.find(".wolmart_add_to_cart_button").attr("value",f),r.find(".wolmart_total_price .woocommerce-Price-amount").html("<bdi>"+u+d.toFixed(2)+"</bdi>"),r.find(".wolmart-data-price").data("price",d.toFixed(2)),(o=r.find(".bought-count span")).text(parseInt(o.text())-1);e.get(0).outerHTML=e.attr("data-content")}}}))}))}(jQuery);